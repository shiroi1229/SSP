```mermaid
graph TD
    subgraph Input
        A[User/System Event]
    end

    subgraph Context Layers
        B(ShortTerm Context)
        C(MidTerm Context)
        D(LongTerm Context)
    end

    subgraph Context Evolution Framework
        E(ContextHistory)
        F(InsightMonitor)
        G(RecoveryPolicyManager)
        H(Learner)
        I(FeedbackLoop)
    end

    subgraph Knowledge Base
        J[Qdrant / memory_store]
    end

    A --> B
    B -- periodically pushes to --> C
    C -- periodically pushes to --> D

    B -- records diff --> E
    C -- records diff --> E
    D -- records diff --> E

    E -- provides history to --> F
    F -- analyzes trends & stability --> G
    G -- triggers recovery actions on --> B
    G -- triggers recovery actions on --> C
    G -- triggers recovery actions on --> D

    F -- identifies learning opportunities --> H
    H -- processes experiences & writes to --> J
    J -- enriches --> D

    I -- connects --> F
    I -- connects --> H
    I -- triggers --> B

    style E fill:#f9f,stroke:#333,stroke-width:2px
    style F fill:#ccf,stroke:#333,stroke-width:2px
    style G fill:#f99,stroke:#333,stroke-width:2px
    style H fill:#cfc,stroke:#333,stroke-width:2px
```
